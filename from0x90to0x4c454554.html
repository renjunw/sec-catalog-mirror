<html>
  <head>
    </head>
    <body>


<div class="post hentry uncustomized-post-template" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
<meta content="4514563088285989046" itemprop="blogId">
<meta content="332687031192292319" itemprop="postId">
<a name="332687031192292319"></a>
<h3 class="post-title entry-title" itemprop="name">
From 0x90 to 0x4c454554, a journey into exploitation.
</h3>
<div class="post-header">
<div class="post-header-line-1"></div>
</div>
<div class="post-body entry-content" id="post-body-332687031192292319" itemprop="description articleBody">
I put some time in and compiled a list in a course type layout to help people in process of learning exploit development. I hope my research will help others spend more time learning and less time searching.
<br>
<br>First off I want to thank the corelan guys for the help they have provided me so far in the process.
<br>
<br>layout: I will be posting in a hierarchical structure, each hierarchy structure should be fully understood before moving on to the next section. I will also post sets of Parallel learning topics that you can use to study in line with other topics to help prevent monotony. These Parallel areas will have a start and end mark which shows when they should be complete in perspective to the overall learning
<br>
<br>desktop background <a href="http://redmine.corelan.be:8800/projects/corelanart/files">Link to Backgrounds</a>
<br>
<br>Other Posts like this one:
<br> Because of quality of these posts I wanted to put them at the top. I could not figure out where to put them in the list because they cover so much. 
<br>  <a href="http://www.abysssec.com/blog/2010/05/past-present-future-of-windows-exploitation/">past-present-future of windows exploitation</a>
<br>  <a href="http://5d4a.wordpress.com/2010/08/02/smashing-the-stack-in-2010/">smashing the stack in 2010</a>
<br>  <a href="https://code.google.com/p/it-sec-catalog/"> IT-Sec-catalog</a>
<br> 
<br><ol>
<br><li style="font-size:20; color:#860834;">Part 1: Programming</li>
<br> Parallel learning #1:(<i>complete this section before getting to the book "Hacking Art of exploitation"</i>)
<br>  While going through the programming area I concentrate on core topics to help us later on with exploit writing. One area that is very good to pick up is some kind of scripting language. Listed below are some of the most popular scripting languages and ones I feel will prove to be the most useful.
<br>   
<br>   Python: One of my favorite languages and growing in popularity python is a powerful language that is easy to use and well documented.
<br>     <a href="http://learnpythonthehardway.org/book/">Learn Python the hard way</a>
<br>     <a href="http://en.wikibooks.org/wiki/Subject:Python_programming_language">Wikibooks Python</a>
<br>     <a href="http://docs.python.org/">http://docs.python.org/</a>
<br>     <a href="http://www.onlinecomputerbooks.com/free-python-books.php">onlinecomputerbooks.com</a>
<br>     <a href="http://oreilly.com/catalog/9781593271923">Grey hat python</a>
<br>     
<br>   Ruby:  If you plan on later on working inside of metasploit this may be the language you want to start with. I highly suggest this for exploit developers to learn.
<br>       <a href="http://en.wikibooks.org/wiki/Subject:Ruby_programming_language">Wikibooks Ruby</a>
<br>       <a href="http://www.sapphiresteel.com/IMG/pdf/LittleBookOfRuby.pdf">LittleBookOfRuby</a>
<br>     <a href="http://www.ruby-doc.org/docs/ProgrammingRuby/">Ruby Programmers Guide</a>
<br>       <a href="http://www.onlinecomputerbooks.com/free-ruby-books.php">onlinecomputerbooks.com</a>
<br>       
<br>   Perl:  An older language that still has a lot of use perl is one of the highest used scripting languages and you will see it used in many exploits. (I would suggest python over perl)
<br>       [book] <a href="http://www.amazon.com/Learning-Perl-5th-Randal-Schwartz/dp/0596520107/ref=sr_1_1?ie=UTF8&amp;s=books&amp;qid=1280901933&amp;sr=8-1">O'Reilly Learning Perl</a>
<br>     <a href="http://www.onlinecomputerbooks.com/free-perl-books.php">onlinecomputerbooks.com</a>
<br>   
<br> 
<br> C and C++ programming:
<br>  It is very important to understand what you are exploiting so to get started let us figure out what we are exploiting. You do not need to go through all of these but when finished with this section you should have a good understanding of C and C++ programming.
<br>  <a href="http://www.cprogramming.com/">Cprogramming.com</a>
<br>  <a href="http://www.java2s.com/Tutorial/C/CatalogC.htm">http://www.java2s.com/Tutorial/C/CatalogC.htm</a>
<br>  <a href="http://beej.us/guide/bgc/">http://beej.us/guide/bgc/</a>
<br>  <a href="http://www.onlinecomputerbooks.com/free-c-books.php">onlinecomputerbooks.com</a>
<br>
<br> X86 Assembly:
<br>  Ok now to understand what the computer reads when we compile C and C++. I am going to mostly stick to the IA-32(X86) assembly language. Read the first link to understand why. It explains it very well.
<br>  <a href="http://www.skullsecurity.org/wiki/index.php/Fundamentals">Skullsecurity: Assembly</a>
<br>  <a href="http://www.acm.uiuc.edu/sigwin/old/workshops/winasmtut.pdf">Windows Assembly Programming Tutorial</a>
<br>  <a href="http://en.wikibooks.org/wiki/X86_Assembly">http://en.wikibooks.org/wiki/X86_Assembly</a>
<br>  [book]<a href="http://homepage.mac.com/randyhyde/webster.cs.ucr.edu/index.html">The Art of Assembly</a>
<br>  <a href="http://www.securitytube.net/Assembly-Primer-for-Hackers-%28Part-1%29-System-Organization-video.aspx">Assembly primer for hackers</a>
<br>  <a href="http://www.drpaulcarter.com/pcasm/">PC Assembly Language</a>
<br>  
<br> Windows Programming:
<br>  This is to help understand what we are programming in and the structure of libraries in the OS. This area is very important far down the line
<br>  <a href="http://en.wikibooks.org/wiki/Windows_Programming">http://en.wikibooks.org/wiki/Windows_Programming</a>
<br>  <a href="http://www.relisoft.com/win32/index.htm">http://www.relisoft.com/win32/index.htm</a>
<br>  [book]<a href="http://www.amazon.com/s/ref=nb_sb_noss?url=search-alias%3Dstripbooks&amp;field-keywords=windows+sysinternals&amp;x=0&amp;y=0">Windows Internals 5</a>
<br>  [book]<a href="http://www.amazon.com/Microsoft-Windows-Internals-4th-Server/dp/0735619174">Windows Internals 4</a>
<br> 
<br> Disassembly:
<br>  Dissassembly is not as much programming as it is what the computer understands and the way it is interpreted from CPU and memory. This is where we start getting into the good stuff. 
<br>  <a href="http://en.wikibooks.org/wiki/X86_Disassembly">http://en.wikibooks.org/wiki/X86_disassembly</a>
<br>  <a href="http://tuts4you.com/download.php?view.187">The Art of Disassembly</a>
<br>
<br>
<br><li style="font-size:20; color:#860834;">Part 2: Getting started</li>
<br> Now that we have a very good understanding of programming languages and what the machine is doing we can start working on task at hand, exploitation.
<br> Here I will start a lot of the learning in very much a list format and adding in comments or Parallel  learning areas when needed.  
<br> 
<br>  <a href="http://www.phrack.org/issues.html?issue=49&amp;id=14#article">Smash the stack for fun and profit (Phrack 49)</a>
<br>  <a href="http://cs.umbc.edu/~chang/cs313.s02/stack.shtml">C function call conventions and the stack</a>
<br>  <a href="http://duartes.org/gustavo/blog/post/anatomy-of-a-program-in-memory">Anatomy of a program in memory</a>
<br>  <a href="http://www.codeguru.com/cpp/misc/misc/assemblylanguage/article.php/c14641">Function Calls, Part 1 (the Basics)</a>
<br>  <a href="http://www.sandpile.org/ia32/index.htm">IA-32 Architecture</a>
<br>  [videos]<a href="http://pentest.cryptocity.net/code-audits/">Code Audit from cryptocity.net</a>
<br>  
<br>  (<b>Parallel  learning #1 finished:</b> You should now have finished on Parallel  learning 1 and have a good understanding of one of the 3 languages)
<br>  
<br>  [Book]<a href="http://www.amazon.com/Hacking-Art-Exploitation-Jon-Erickson/dp/1593271441/ref=sr_1_fkmr1_1?ie=UTF8&amp;qid=1280905635&amp;sr=1-1-fkmr1">Hacking art of exploitation [Chapter 1&amp;2]</a>
<br>  <a href="http://www.corelan.be:8800/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/">Corelan T1</a>
<br>  <a href="http://www.corelan.be:8800/index.php/2009/07/23/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2/">Corelan T2</a>
<br>  
<br>  Parallel  learning #2:(<i>complete this section before end of part 2</i>)
<br>    (Read the first few posts on this blog has some good info)
<br>    <a href="http://blog.ksplice.com/2010/03/">Kspice blog</a>
<br>    (Read some of the post from this blog they are very helpful with starting out with fuzzers.)
<br>    <a href="http://www.nullthreat.net/">Nullthreat's blog</a>
<br>    (I am linked directly to a demo exploit for this area but this is a useful blog to keep track of for many things)
<br>    <a href="http://www.darklevel.org/index.php?option=com_content&amp;task=view&amp;id=54&amp;Itemid=89">A demo exploit</a>
<br>   
<br>  <a href="http://www.tenouk.com/Bufferoverflowc/stackbasedbufferoverflow.html">tenouk.com: Buffer overflow intro</a>
<br>  <a href="http://www.cultdeadcow.com/cDc_files/cDc-351/index.html">The Tao of Windows Buffer Overflow</a>
<br>  <a href="http://nsfsecurity.pr.erau.edu/bom/index.html">nsfsecurity on BOF</a>
<br>  <a href="http://www.hackerscenter.com/index.php?/Downloads/Library/Application-Security/View-category.html">Hacker center: BOF</a>
<br>  [video]<a href="http://www.securitytube.net/Buffer-Overflow-Primer-Part-1-%28Smashing-the-Stack%29-video.aspx">Buffer overflow Primer</a>
<br>  [Book]<a href="http://www.amazon.com/Shellcoders-Handbook-Discovering-Exploiting-Security/dp/047008023X/ref=sr_1_1?ie=UTF8&amp;s=books&amp;qid=1282450549&amp;sr=8-1">Shellcoder's Handbook Ch1&amp;2</a>
<br>  [Book]<a href="http://www.amazon.com/Hacking-Art-Exploitation-Jon-Erickson/dp/1593271441/ref=sr_1_fkmr1_1?ie=UTF8&amp;qid=1280905635&amp;sr=1-1-fkmr1">Hacking art of exploitation [Chapter 3]</a>
<br>  <a href="http://www.corelan.be:8800/index.php/2009/07/25/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-3-seh/">Corelan T3A</a>
<br>  <a href="http://www.corelan.be:8800/index.php/2009/07/28/seh-based-exploit-writing-tutorial-continued-just-another-example-part-3b/">Corelan T3B</a>
<br>  <a href="http://www.ethicalhacker.net/content/view/309/2/">SEH Based Exploits and the development process</a>
<br>  <a href="http://www.shell-storm.org/papers/files/405.pdf">SEH overwrite simplified</a>
<br> 
<br>  ((<b>Parallel  learning #2 finished:</b>)
<br>  
<br><li style="font-size:20; color:#860834;">Part 3:Tools of the trade</li>
<br>  This is a list of tools I have started using and find very useful. 
<br>  <a href="http://www.immunityinc.com/products-immdbg.shtml">Immunity Debugger</a>
<br>  <a href="http://www.ollydbg.de/">Ollydbg</a>
<br>  <a href="http://www.microsoft.com/whdc/devtools/debugging/installx86.mspx">Windbg</a>
<br>  <a href="http://www.hex-rays.com/idapro/">IDA Pro</a>
<br>  <a href="">explorer suite</a>
<br>  <a href="http://technet.microsoft.com/en-us/sysinternals/bb795533.aspx">Sysinternals</a>
<br> 
<br> And here are some corelan posts on how to use them. I will supply more in future but this is a very good start.
<br>  <a href="http://www.corelan.be:8800/index.php/2009/09/05/exploit-writing-tutorial-part-5-how-debugger-modules-plugins-can-speed-up-basic-exploit-development/">Corelan T5</a>
<br>  <a href="http://www.corelan.be:8800/index.php/2010/01/26/starting-to-write-immunity-debugger-pycommands-my-cheatsheet/">Corelan: Immunity debugger cheatsheet</a>
<br> 
<br><li style="font-size:20; color:#860834;">Part 4: Network and Metasploit</li>
<br>  (Networking)
<br>  <a href="http://beej.us/guide/bgnet/output/html/multipage/index.html">Beej.us network programming</a>
<br>  [Book]<a href="http://www.amazon.com/Hacking-Art-Exploitation-Jon-Erickson/dp/1593271441/ref=sr_1_fkmr1_1?ie=UTF8&amp;qid=1280905635&amp;sr=1-1-fkmr1">Hacking art of exploitation [Chapter 4]</a>
<br>  <a href="https://www6.software.ibm.com/developerworks/education/l-rubysocks/l-rubysocks-a4.pdf">Socket Programming in ruby</a>
<br>  
<br>  (Metasploit)
<br>  [Video]<a href="http://www.securitytube.net/Metasploit-Megaprimer-%28Exploitation-Basics-and-need-for-Metasploit%29-Part-1-video.aspx">Security Tube: Metasploit Megaprimer
<br>  </a><a href="http://www.metasploit.com/">Metasploit.com</a>
<br>  <a href="http://www.offensive-security.com/metasploit-unleashed/">Metasploit Unleashed</a>
<br>  [video]<a href="http://www.irongeek.com/i.php?page=videos/metasploit-class">Metasploit Louisville Class</a>
<br>  <a href="http://blog.metasploit.com/2010/05/introducing-metasploitable.html">Metasploitable (a target)</a>
<br>  <a href="http://www.corelan.be:8800/index.php/2009/08/12/exploit-writing-tutorials-part-4-from-exploit-to-metasploit-the-basics/">Corelan T4</a>
<br>  <a href="http://guides.intern0t.net/msf2.php">intern0t: developing my first exploit</a>
<br>  [video]<a href="http://www.youtube.com/user/DHAtEnclaveForensics#p/u/9/rGlvgeeU0vQ">DHAtEnclaveForensics: Exploit Creation in Metasploit</a>
<br>  <a href="http://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit">Wikibooks Metasploit/Writing Windows Exploit</a>
<br>
<br><li style="font-size:20; color:#860834;">Part 5: Shellcode</li>
<br>  <a href="http://www.corelan.be:8800/index.php/2010/02/25/exploit-writing-tutorial-part-9-introduction-to-win32-shellcoding/">Corelan T9</a>
<br>  <a href="http://projectshellcode.com/?q=node/12">projectShellcode: Shellcode Tutorial</a>
<br>  [Book]<a href="http://www.amazon.com/Shellcoders-Handbook-Discovering-Exploiting-Security/dp/047008023X/ref=sr_1_1?ie=UTF8&amp;s=books&amp;qid=1282450549&amp;sr=8-1">Shellcoder's Handbook Ch3</a>
<br>  [Book]<a href="http://www.amazon.com/Hacking-Art-Exploitation-Jon-Erickson/dp/1593271441/ref=sr_1_fkmr1_1?ie=UTF8&amp;qid=1280905635&amp;sr=1-1-fkmr1">Hacking art of exploitation [Chapter 5]</a>
<br>  <a href="http://www.shell-storm.org/papers/files/440.pdf">Writing small shellcode</a>
<br>  <a href="http://www.shell-storm.org/shellcode/">Shell-storm Shellcode database</a>
<br>  <a href="http://www.vividmachines.com/shellcode/shellcode.html#as">Advanced shellcode</a>
<br> 
<br><li style="font-size:20; color:#860834;">Part 6: Engineering in Reverse</li>
<br>  Parallel Learning #3:(constant place to reference and use for reversing)
<br>  <a href="http://www.reteam.org/papers/e57.pdf">Understanding Code</a>
<br>  <a href="http://mattoh.wordpress.com/">Reverse Engineering the World</a>
<br>  <a href="http://tuts4you.com/download.php?list.17">Reversing for Newbies</a>
<br>  <a href="http://www.room362.com/blog/2009/6/12/getting-your-fill-of-reverse-engineering-and-malware-analysi.html">Room362.com reversing blog post</a>
<br>  <a href="http://www.ethicalhacker.net/content/view/152/2/">Ethicalhacker.net intro to reverse engineering</a>
<br>  <a href="http://www.acm.uiuc.edu/sigmil/RevEng/">acm.uiuc.edu Intro to Reverse Engineering software</a>
<br>  [Book]<a href="http://www.amazon.com/Reversing-Secrets-Engineering-Eldad-Eilam/dp/0764574817/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1280937813&amp;sr=1-1">Reversing: secrets of reverse engineering</a>
<br>  [video]<a href="http://pentest.cryptocity.net/reverse-engineering/">Reverse Engineering from cryptocity.net</a>
<br>  <a href="http://www.woodmann.com/crackz/">CrackZ's Reverse Engineering Page</a>
<br>  <a href="http://www.securitytube.net/Reverse-Engineering-Techniques-to-find-Security-Vulnerabilities-video.aspx">Reverse engineering techniques</a>
<br>  <a href="http://dl.dropbox.com/u/5489930/CBM_1_2_2006_Goppit_PE_Format_Reverse_Engineer_View.pdf">CBM_1_2_2006_Goppit_PE_Format_Reverse_Engineer_View</a>
<br>  <a href="http://securitylabs.websense.com/content/Assets/HistoryofPackingTechnology.pdf">HistoryofPackingTechnology</a>
<br>  <a href="http://marcoramilli.blogspot.com/2010/12/windows-pe-header.html">Windows PE Header</a>
<br>  <a href="http://www.openrce.org/articles/">OpenRCE Articles</a>
<br> 
<br>  [GAME]<a href="http://crackmes.de/">Crackmes.de</a>
<br> 
<br><li style="font-size:20; color:#860834;">Part 7: Getting a little deeper into BOF</li>
<br> Parallel  Learning #4:(To the end of the course and beyond)
<br>   Find old exploits on <a href="http://www.exploit-db.com/">Exploit-db</a> download them, test them, rewrite them, understand them.
<br>   
<br>   (Part A: preventions)
<br>  <a href="http://en.wikipedia.org/wiki/Buffer_overflow_protection">Buffer overflow protection</a>
<br>  <a href="http://technet.microsoft.com/en-us/security/dd285253.aspx">The evolution of Microsoft's Mitigations</a>
<br>  <a href="http://www.cs.purdue.edu/homes/mkirkpat/papers/canbit.pdf">Purdue.edu: Canary Bit</a>
<br>  <a href="http://blogs.technet.com/b/srd/archive/2009/02/02/preventing-the-exploitation-of-seh-overwrites-with-sehop.aspx">Preventing the exploitation of SEH Overwrites with SEHOP</a>
<br>  <a href="http://www.sysdream.com/articles/sehop_en.pdf">Bypassing SEHOP</a>
<br>  <a href="http://en.wikipedia.org/wiki/Executable_space_protection">Wikipedia Executable space protextion</a>
<br>  <a href="http://en.wikipedia.org/wiki/Data_Execution_Prevention"> Wikipedia DEP</a>
<br>  <a href="http://www.securestate.com/Docs/Bypassing_Hardware_based_Data_Execution_Prevention.pdf">Bypassing Hardware based DEP</a>
<br>  <a href="http://en.wikipedia.org/wiki/ASLR">Wikipedia ASLR</a>
<br>  <a href="http://www.symantec.com/avcenter/reference/Address_Space_Layout_Randomization.pdf">Symantec ASLR in Vista</a>
<br>  <a href="http://www.ngssoftware.com/papers/defeating-w2k3-stack-protection.pdf">Defeating the Stack Based Buffer Overflow Prevention</a>
<br>  <a href="http://www.corelan.be:8800/index.php/2009/09/21/exploit-writing-tutorial-part-6-bypassing-stack-cookies-safeseh-hw-dep-and-aslr/">Corelan T6</a>
<br>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Return-to-libc_attack">Return to libc</a>
<br>  [video] <a href="http://technet.microsoft.com/en-us/security/dd285253.aspx"> microsoft protections video </a>
<br>  
<br>    (Part B: Advanced BOF)
<br>  [video]<a href="http://pentest.cryptocity.net/exploitation/">Exploitation from cryptocity.net</a>
<br>  <a href="http://www.corelan.be:8800/index.php/2009/11/06/exploit-writing-tutorial-part-7-unicode-from-0x00410041-to-calc/">Corelan T7</a>
<br>  <a href="http://www.corelan.be:8800/index.php/2010/01/09/exploit-writing-tutorial-part-8-win32-egg-hunting/">Corelan T8</a>
<br>  <a href="http://www.corelan.be:8800/index.php/2010/06/16/exploit-writing-tutorial-part-10-chaining-dep-with-rop-the-rubikstm-cube/">Corelan T10</a>
<br>  <a href="http://www.youtube.com/watch?v=UIKy1Shxd6Q&amp;feature=related">Virtual Worlds - Real Exploits</a>
<br>  
<br>  [GAME]<a href="http://community.corest.com/~gera/">Gera's Insecure Programming</a>
<br>  [GAME]<a href="http://www.smashthestack.org/">Smash the stack wargaming network</a>
<br>  
<br><li style="font-size:20; color:#860834;">Part 8: Heap overflow</li>
<br>  <a href="http://www.exploit-db.com/download_pdf/15982">Heap Overflows for Humans-101</a>
<br>  <a href="http://pthreads.blogspot.com/2007/04/heap-overflow.html">rm -rf / on heap overflow</a>
<br>  <a href="http://www.w00w00.org/files/articles/heaptut.txt">w00w00 on heap overflow</a>
<br>  [book]<a href="http://www.amazon.com/Shellcoders-Handbook-Discovering-Exploiting-Security/dp/047008023X/ref=sr_1_1?ie=UTF8&amp;s=books&amp;qid=1282450549&amp;sr=8-1">Shellcoder's Handbook Ch4&amp;5</a>
<br>  <a href="http://www.h-online.com/security/features/A-Heap-of-Risk-747161.html">h-online A heap of Risk</a>
<br>  [video]<a href="http://video.google.com/videoplay?docid=1985155227368288256#">Defcon 15 remedial Heap Overflows</a>
<br>  <a href="http://www.thehackerslibrary.com/?p=872">heap overflow: ancient art of unlink seduction</a>
<br>  <a href="http://advancedwindowsdebugging.com/ch06.pdf">Memory corruptions part II -- heap</a>
<br>  
<br>  [book]<a href="http://www.amazon.com/Shellcoders-Handbook-Discovering-Exploiting-Security/dp/047008023X/ref=sr_1_1?ie=UTF8&amp;s=books&amp;qid=1282450549&amp;sr=8-1">Read the rest of Shellcoder's Handbook</a>
<br>  
<br><li style="font-size:20; color:#860834;">Part 9: Exploit listing sites</li>
<br>  <a href="http://www.exploit-db.com/">Exploit-DB</a>
<br>  <a href="http://inj3ct0r.com/">Injector</a>
<br>  <a href="http://www.cvedetails.com/">CVE Details</a>
<br>  <a href="http://www.packetstormsecurity.org/assess/exploits/">Packetstorm</a>
<br>  <a href="http://www.us-cert.gov/cas/techalerts/">CERT</a>
<br>  <a href="http://cve.mitre.org/cve/index.html">Mitre</a>
<br>  <a href="http://web.nvd.nist.gov/view/vuln/search?cid=3">National Vulnerability Database</a>
<br>  
<br>  (bonus: site that lists types of vulnerabilties and info)
<br>  <a href="http://cwe.mitre.org/index.html">Common Weakness Enumberation</a>
<br>  
<br><li style="font-size:20; color:#860834;">Part 10: To come</li>
<br>  1. Fuzzing 
<br>  2. File Format
<br>  3. and more
<br></ol>
<br>
<br>If anyone has any good links to add post a comment and I will try to add them or send me the link and I will review and add it. 
<br>
<br>If anyone finds any bad or false information in any of these tutorials please let me know. I do not want people reading this getting bad information.
<div style="clear: both;"></div>
</div>
<div class="post-footer">
</div>
</div>
</div>
      </body>
  </html>
